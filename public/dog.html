<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Te Reo Kuri Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center py-10 px-4">

    <div id="app" class="bg-white rounded-3xl shadow-xl overflow-hidden max-w-4xl w-full p-8 transition-all duration-300 transform scale-100">

        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl sm:text-5xl font-bold text-gray-800 tracking-tight">Te Reo Kuri Quiz</h1>
            <p class="mt-2 text-lg text-gray-500">Click the words in the correct order to form the sentence.</p>
        </header>

        <!-- Image Container -->
        <div class="mb-8 rounded-2xl overflow-hidden shadow-lg border-4 border-gray-100">
            <img 
                src="https://www.auckland.ac.nz/content/auckland/en/news/2022/04/05/a-dog-s-life-the-fate-of-maori-kuri/jcr:content/leftpar/imagecomponent/image.img.1024.medium.jpg/1648886845056.jpg" 
                alt="A black dog looking back at the camera." 
                class="w-full h-auto object-cover"
            >
        </div>

        <!-- Question & Interactive Area -->
        <div class="space-y-6">

            <!-- Current Sentence Display -->
            <div id="user-sentence-container" class="min-h-[80px] bg-gray-50 border-2 border-dashed border-gray-300 rounded-xl flex flex-wrap items-center gap-3 p-4">
                <!-- Words clicked by user will appear here -->
            </div>

            <!-- Word Buttons -->
            <div id="word-buttons-container" class="flex flex-wrap justify-center gap-3 p-4 bg-gray-50 rounded-xl shadow-inner">
                <!-- Word buttons will be generated here -->
            </div>

            <!-- Controls and Feedback -->
            <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
                <button id="check-btn" class="w-full sm:w-auto px-6 py-3 bg-indigo-600 text-white font-semibold rounded-full shadow-lg hover:bg-indigo-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                    Check Answer
                </button>
                <button id="next-btn" class="w-full sm:w-auto px-6 py-3 bg-gray-200 text-gray-700 font-semibold rounded-full shadow-lg hover:bg-gray-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 hidden">
                    Next Question
                </button>
                <button id="reset-btn" class="w-full sm:w-auto px-6 py-3 bg-red-500 text-white font-semibold rounded-full shadow-lg hover:bg-red-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 hidden">
                    Reset
                </button>
            </div>
            
            <!-- Feedback Message -->
            <div id="feedback-message" class="text-center font-semibold text-lg min-h-[40px] flex items-center justify-center"></div>

        </div>
    </div>

    <!-- Modal for showing translation and moving to next question -->
    <div id="success-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl p-6 sm:p-8 max-w-sm w-full text-center">
            <h3 id="modal-title" class="text-2xl font-bold text-gray-800 mb-2">Pai tō mahi!</h3>
            <p id="modal-translation" class="text-gray-600 mb-4 text-lg italic"></p>
            <button id="modal-next-btn" class="w-full px-6 py-3 bg-indigo-600 text-white font-semibold rounded-full hover:bg-indigo-700 transition-colors">
                Next
            </button>
        </div>
    </div>

    <script>
        // Data for the questions
        const questions = [
            {
                maoriSentence: "Kei te moe te kurī.",
                englishTranslation: "The dog is sleeping.",
            },
            {
                maoriSentence: "He kuri pai tōku.",
                englishTranslation: "My dog is a good dog.",
            },
            {
                maoriSentence: "E kai ana te kuri i te kai.",
                englishTranslation: "The dog is eating the food.",
            },
            {
                maoriSentence: "Kei te harikoa te kurī.",
                englishTranslation: "The dog is happy.",
            }
        ];

        let currentQuestionIndex = 0;
        let userSentence = [];

        // DOM elements
        const userSentenceContainer = document.getElementById('user-sentence-container');
        const wordButtonsContainer = document.getElementById('word-buttons-container');
        const checkBtn = document.getElementById('check-btn');
        const nextBtn = document.getElementById('next-btn');
        const resetBtn = document.getElementById('reset-btn');
        const feedbackMessage = document.getElementById('feedback-message');
        const successModal = document.getElementById('success-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalTranslation = document.getElementById('modal-translation');
        const modalNextBtn = document.getElementById('modal-next-btn');

        // Shuffles an array randomly
        const shuffleArray = (array) => {
            const shuffledArray = [...array];
            for (let i = shuffledArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledArray[i], shuffledArray[j]] = [shuffledArray[j], shuffledArray[i]];
            }
            return shuffledArray;
        };

        // Renders the current question
        const renderQuestion = () => {
            userSentence = [];
            userSentenceContainer.innerHTML = '';
            feedbackMessage.textContent = '';
            wordButtonsContainer.innerHTML = '';
            checkBtn.classList.remove('hidden');
            nextBtn.classList.add('hidden');
            resetBtn.classList.add('hidden');
            
            const currentQuestion = questions[currentQuestionIndex];
            const words = currentQuestion.maoriSentence.split(' ');
            const shuffledWords = shuffleArray(words);

            shuffledWords.forEach((word) => {
                const button = document.createElement('button');
                button.textContent = word;
                button.classList.add('px-4', 'py-2', 'bg-gray-200', 'text-gray-800', 'font-semibold', 'rounded-full', 'shadow', 'hover:bg-gray-300', 'transition-colors', 'duration-200', 'cursor-pointer');
                button.addEventListener('click', () => handleWordClick(button, word));
                wordButtonsContainer.appendChild(button);
            });
        };

        // Handles a click on a word button
        const handleWordClick = (button, word) => {
            // Add the word to the user's sentence array
            userSentence.push(word);
            
            // Add a visual representation to the sentence container
            const wordSpan = document.createElement('span');
            wordSpan.textContent = word;
            wordSpan.classList.add('px-3', 'py-1', 'bg-indigo-100', 'text-indigo-800', 'rounded-full', 'font-medium', 'text-sm', 'cursor-pointer', 'select-none');
            wordSpan.addEventListener('click', () => removeWordFromSentence(wordSpan, word));
            userSentenceContainer.appendChild(wordSpan);

            // Hide the button from the word bank
            button.style.display = 'none';
            resetBtn.classList.remove('hidden');
        };

        // Removes a word from the user's sentence
        const removeWordFromSentence = (wordSpan, word) => {
            // Remove the word from the user's sentence array
            const index = userSentence.indexOf(word);
            if (index > -1) {
                userSentence.splice(index, 1);
            }
            
            // Remove the span from the UI
            wordSpan.remove();

            // Find the original button and show it again
            const buttons = wordButtonsContainer.querySelectorAll('button');
            buttons.forEach(button => {
                if (button.textContent === word && button.style.display === 'none') {
                    button.style.display = '';
                }
            });
            
            // If the sentence is empty, hide the reset button
            if (userSentence.length === 0) {
                resetBtn.classList.add('hidden');
            }
        };

        // Checks the user's answer
        const checkAnswer = () => {
            const currentQuestion = questions[currentQuestionIndex];
            const correctSentence = currentQuestion.maoriSentence.split(' ').join(' ');
            const userSentenceString = userSentence.join(' ');

            if (userSentenceString === correctSentence) {
                // Correct answer
                modalTitle.textContent = "Pai tō mahi!"; // Good job!
                modalTranslation.textContent = currentQuestion.englishTranslation;
                successModal.classList.remove('hidden');
                checkBtn.classList.add('hidden');
            } else {
                // Incorrect answer
                feedbackMessage.textContent = "Kāore i te tika. Ngana anō."; // That is not correct. Try again.
                feedbackMessage.classList.add('text-red-500');
                feedbackMessage.classList.remove('text-green-500');
            }
        };

        // Moves to the next question or ends the game
        const nextQuestion = () => {
            successModal.classList.add('hidden');
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                renderQuestion();
            } else {
                // Game over
                feedbackMessage.textContent = "Kua oti i a koe! Ka pai!"; // You have finished! Well done!
                feedbackMessage.classList.add('text-green-500');
                feedbackMessage.classList.remove('text-red-500');
                wordButtonsContainer.innerHTML = '';
                checkBtn.classList.add('hidden');
                nextBtn.classList.add('hidden');
                resetBtn.classList.add('hidden');
            }
        };

        // Resets the current question
        const resetCurrentQuestion = () => {
            userSentence = [];
            userSentenceContainer.innerHTML = '';
            wordButtonsContainer.innerHTML = '';
            feedbackMessage.textContent = '';
            feedbackMessage.classList.remove('text-red-500', 'text-green-500');
            resetBtn.classList.add('hidden');
            
            const currentQuestion = questions[currentQuestionIndex];
            const words = currentQuestion.maoriSentence.split(' ');
            const shuffledWords = shuffleArray(words);
            
            shuffledWords.forEach((word) => {
                const button = document.createElement('button');
                button.textContent = word;
                button.classList.add('px-4', 'py-2', 'bg-gray-200', 'text-gray-800', 'font-semibold', 'rounded-full', 'shadow', 'hover:bg-gray-300', 'transition-colors', 'duration-200', 'cursor-pointer');
                button.addEventListener('click', () => handleWordClick(button, word));
                wordButtonsContainer.appendChild(button);
            });
        };

        // Event listeners
        checkBtn.addEventListener('click', checkAnswer);
        modalNextBtn.addEventListener('click', nextQuestion);
        resetBtn.addEventListener('click', resetCurrentQuestion);

        // Initial render
        window.onload = renderQuestion;

    </script>
</body>
</html>