<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mihi Whakatau – Vocabulary Practice</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap" rel="stylesheet">
  <style>
    body{
      font-family:Arial,sans-serif;padding:20px;background:#f0f9ff;margin:0;line-height:1.5;
    }
    .header-container{
      display:flex;flex-wrap:wrap;align-items:center;gap:20px;margin-bottom:20px;
      position:relative;
    }
    .header-container h2{margin:0;font-size:1.8rem;}
    .new-set-btn{
      position:absolute;right:0;top:50%;transform:translateY(-50%);
      background:#00008B;color:#fff;padding:8px 16px;border:none;border-radius:8px;
      font-weight:600;cursor:pointer;font-size:0.9rem;
    }
    .new-set-btn:hover{background:#0000CD;}

    /* DROPDOWN */
    .selector-container{
      background:#ADD8E6;border:3px solid #00008B;border-radius:15px;
      padding:5px 15px;display:inline-block;
    }
    #category-selector{
      min-width:300px;background:transparent;border:none;
      font-family:'Poppins',sans-serif;font-size:clamp(1.8rem,5vw,2.5rem);
      font-weight:700;color:#333;cursor:pointer;
      -webkit-appearance:none;-moz-appearance:none;appearance:none;
      text-align:center;text-align-last:center;
    }

    /* FLASHCARDS */
    #flashcards-section{
      display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:30px;
    }
    .card{
      height:100px;padding:10px;border:4px solid #333;border-radius:10px;
      cursor:pointer;display:flex;align-items:center;justify-content:center;
      text-align:center;font-weight:bold;font-size:18px;word-wrap:break-word;
      background:lightyellow;user-select:none;position:relative;
      transform-style:preserve-3d;transition:transform .6s;
    }
    .card .face{
      position:absolute;width:100%;height:100%;backface-visibility:hidden;
      display:flex;align-items:center;justify-content:center;padding:10px;
      box-sizing:border-box;
    }
    .card .front{background:lightyellow;}
    .card .back{
      background:lightblue;transform:rotateY(180deg);
    }
    .card.flipped{transform:rotateY(180deg);}

    /* QUIZ */
    #quiz-section .quiz-question{
      margin-bottom:25px;border-top:2px solid #ccc;padding-top:15px;
    }
    #quiz-section .quiz-question b{
      font-size:1.3em;margin-bottom:12px;display:block;color:#222;
    }
    .quiz-options{
      display:grid;grid-template-columns:repeat(4,1fr);gap:10px;
    }
    #quiz-section .quiz-options button{
      font-size:16px;padding:10px;width:100%;border:2px solid #666;
      border-radius:8px;background:#fff;cursor:pointer;transition:all .3s;
    }
    #quiz-section .quiz-options button:disabled{
      cursor:not-allowed;opacity:.8;
    }

    /* MATCHING */
    .matched-container{
      display:flex;flex-direction:column;gap:10px;margin-bottom:15px;
    }
    .pair{
      padding:10px 15px;border-radius:8px;font-weight:bold;
      display:flex;justify-content:center;gap:8px;align-items:center;
      font-size:1.4rem;text-align:center;
    }
    .pair .sep{font-weight:bold;color:#333;}
    .matching-container{
      display:flex;justify-content:space-between;gap:20px;margin-top:20px;
    }
    .matching-box{
      flex:1;display:grid;grid-template-columns:repeat(2,1fr);
      align-content:start;gap:10px;min-height:200px;
      border:2px dashed #ccc;padding:10px;border-radius:10px;background:#fafafa;
    }
    #matching-section .drag-item{
      height:50px;border:2px solid #666;background:#eee;cursor:pointer;
      text-align:center;display:flex;align-items:center;justify-content:center;
      font-weight:bold;font-size:18px;box-sizing:border-box;border-radius:6px;
      transition:all .2s;
    }
    #matching-section .drag-item.selected{
      border:3px solid blue;transform:scale(1.05);
    }

    /* MOBILE */
    @media (max-width:768px){
      .header-container h2{font-size:1.5rem;}
      #flashcards-section{grid-template-columns:repeat(2,1fr);}
      .quiz-options{grid-template-columns:repeat(2,1fr);}
      .matching-container{flex-direction:column;gap:15px;}
      .matching-box{grid-template-columns:1fr;}
      #matching-section .drag-item{font-size:16px;}
      .pair{font-size:1.1rem;}
      #category-selector{min-width:250px;font-size:1.8rem;}
    }
    @media (max-width:480px){
      .header-container{flex-direction:column;align-items:stretch;}
      .selector-container{width:100%;}
      #category-selector{width:100%;min-width:auto;}
      .new-set-btn{position:static;transform:none;margin-top:10px;width:100%;}
    }
  </style>
</head>
<body>

<div class="header-container">
  <h2>Mihi Whakatau – Vocabulary Practice</h2>
  <div class="selector-container">
    <select id="category-selector" onchange="updateContent()">
      <option value="mihiwhakatau" selected>Mihi Whakatau</option>
    </select>
  </div>
  <button class="new-set-btn" onclick="newSet()">New Set</button>
</div>

<h3>Flashcards</h3>
<div id="flashcards-section"></div>

<h3>Quiz</h3>
<div id="quiz-section"></div>

<h3>Matching - CLICK - CLICK</h3>
<div class="matched-container" id="matched-pairs"></div>
<div id="matching-section"></div>

<script>
/* ---------- DATA ---------- */
const data = {
  mihiwhakatau: [
    {mi:"Tēnā koutou katoa",en:"Greetings to you all"},
    {mi:"Ko Perehipitīriana te Hāhi",en:"Presbyterian is the Church"},
    {mi:"Ko Hāto Kēneti te tangata",en:"Saint Kentigern is the person"},
    {mi:"Ko Hāto Kēneti te kura",en:"Saint Kentigern is the school"},
    {mi:"Me ū ki te whakapono",en:"Hold fast to the faith"},
    {mi:"Tīhei Mauri Ora",en:"Behold, the breath of life"},
    {mi:"Ko te mihi tuatahi",en:"The first greeting"},
    {mi:"Ki te atua",en:"To God"},
    {mi:"Nānā nei ngā mea katoa",en:"By whom all things were made"},
    {mi:"Ko te mihi tuarua",en:"The second greeting"},
    {mi:"Ki te hunga mate",en:"To those who have passed on"},
    {mi:"Haere, haere, haere atu rā",en:"Go, go, go on your way"},
    {mi:"Ki a tātou te hunga ora",en:"To us, the living"},
    {mi:"E huihui mai nei",en:"Who gather here"},
    {mi:"Kia kaha",en:"Be strong"},
    {mi:"Kia maia",en:"Be brave"},
    {mi:"Kia manawanui",en:"Be steadfast"},
    {mi:"Tēnā hoki koutou",en:"Acknowledgements also to you"},
    {mi:"E te mana whenua",en:"The local people"},
    {mi:"Kua tae mai mātou",en:"We have arrived"},
    {mi:"Ki te tautoko i te kaupapa",en:"To support the purpose"},
    {mi:"O te wā",en:"Of this time"},
    {mi:"Arā, ko te whanaungatanga",en:"That is, relationships and connection"},
    {mi:"Ahakoa he iti",en:"Although it is small"},
    {mi:"He pounamu",en:"It is precious like greenstone"},
    {mi:"Nō reira",en:"Therefore"},
    {mi:"Tēnā koutou",en:"Greetings to you"},
    {mi:"Katoa",en:"All"},
    {mi:"Waiata tautoko",en:"Supporting song"},
    {mi:"Mā wai rā",en:"Who will it be"}
  ]
};

let selectedWords = [];

/* ---------- UTILS ---------- */
function shuffleArray(arr){
  const a=[...arr];
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}

/* ---------- FLASHCARDS ---------- */
function showFlashcards(){
  const container=document.getElementById('flashcards-section');
  container.innerHTML='';
  if(!selectedWords.length){
    container.innerHTML='<p style="grid-column:1/-1;text-align:center;color:#666;">No data found</p>';
    return;
  }
  selectedWords.forEach(item=>{
    const card=document.createElement('div');
    card.className='card';

    const front=document.createElement('div');
    front.className='face front';
    front.textContent=item.mi;

    const back=document.createElement('div');
    back.className='face back';
    back.textContent=item.en;

    card.append(front,back);
    card.onclick=()=>card.classList.toggle('flipped');

    container.appendChild(card);
  });
}

/* ---------- QUIZ ---------- */
function showQuiz(){
  const container=document.getElementById('quiz-section');
  container.innerHTML='';
  if(selectedWords.length<4){
    container.innerHTML='<p style="color:#666;">Not enough words for a quiz (need at least 4).</p>';
    return;
  }
  const allEn=data.mihiwhakatau.map(d=>d.en);

  selectedWords.forEach(item=>{
    const qDiv=document.createElement('div');
    qDiv.className='quiz-question';
    qDiv.innerHTML=`<b>${item.mi}</b>`;

    const optsDiv=document.createElement('div');
    optsDiv.className='quiz-options';

    const distractors=[];
    while(distractors.length<3){
      const r=allEn[Math.floor(Math.random()*allEn.length)];
      if(r!==item.en && !distractors.includes(r)) distractors.push(r);
    }
    const options=shuffleArray([item.en,...distractors]);

    options.forEach(opt=>{
      const btn=document.createElement('button');
      btn.textContent=opt;
      btn.onclick=()=>{
        if(btn.disabled) return;
        const correct=opt===item.en;
        btn.style.backgroundColor=correct?'#90EE90':'#FFB6C1';
        btn.style.color=correct?'#000':'#900';
        optsDiv.querySelectorAll('button').forEach(b=>b.disabled=true);
      };
      optsDiv.appendChild(btn);
    });
    qDiv.appendChild(optsDiv);
    container.appendChild(qDiv);
  });
}

/* ---------- MATCHING ---------- */
function showMatching(){
  const section=document.getElementById('matching-section');
  const matched=document.getElementById('matched-pairs');
  section.innerHTML=''; matched.innerHTML='';

  if(!selectedWords.length){
    section.innerHTML='<p style="text-align:center;color:#666;">No data found</p>';
    return;
  }

  const wrapper=document.createElement('div');
  wrapper.className='matching-container';
  section.appendChild(wrapper);

  const left=document.createElement('div');
  left.className='matching-box';
  const right=document.createElement('div');
  right.className='matching-box';
  wrapper.append(left,right);

  const leftItems=selectedWords.map(d=>({word:d.mi,pair:d.en}));
  const rightItems=shuffleArray(selectedWords.map(d=>({word:d.en,pair:d.mi})));

  let first=null;
  const palette=['#FFB3B3','#FFD1A3','#FFF3A3','#C9F7B5','#B7F0F6','#C9C6FF','#F7B3FF','#DE85A6','#F0A326','#E9FC6D','#28992a','#43a6e8'];
  let colIdx=0;

  const createBox=(item,side)=>{
    const div=document.createElement('div');
    div.className='drag-item';
    div.textContent=item.word;
    div.dataset.side=side;
    div.dataset.word=item.word;
    div.dataset.pair=item.pair;
    div.onclick=()=>handleClick(div);
    return div;
  };

  const handleClick=(box)=>{
    if(box.style.backgroundColor) return;
    if(!first){
      first=box; box.classList.add('selected');
    }else if(box.dataset.side!==first.dataset.side){
      const leftW = first.dataset.side==='left'?first.dataset.word:box.dataset.word;
      const rightW= first.dataset.side==='right'?first.dataset.word:box.dataset.word;
      const correct=selectedWords.some(p=>p.mi===leftW && p.en===rightW);
      if(correct){
        const col=palette[colIdx%palette.length]; colIdx++;
        [first,box].forEach(el=>{
          el.style.backgroundColor=col;
          el.style.borderColor='#444';
          el.classList.remove('selected');
          el.onclick=null;
        });
        const chip=document.createElement('div');
        chip.className='pair';
        chip.style.backgroundColor=col;
        chip.innerHTML=`<span>${leftW}</span><span class="sep">↔</span><span>${rightW}</span>`;
        matched.appendChild(chip);
      }else{
        first.classList.add('selected');
        box.classList.add('selected');
        setTimeout(()=>{first.classList.remove('selected');box.classList.remove('selected');},600);
      }
      first=null;
    }else{
      first.classList.remove('selected');
      first=box; box.classList.add('selected');
    }
  };

  leftItems.forEach(i=>left.appendChild(createBox(i,'left')));
  rightItems.forEach(i=>right.appendChild(createBox(i,'right')));
}

/* ---------- MAIN ---------- */
function updateContent(){
  const cat=document.getElementById('category-selector').value;
  const list=data[cat]||[];
  selectedWords=shuffleArray([...list]).slice(0,12);
  showFlashcards();
  showQuiz();
  showMatching();
}
function newSet(){
  updateContent();   // just re-shuffle a fresh 12-word set
}
updateContent();
</script>
</body>
</html>
