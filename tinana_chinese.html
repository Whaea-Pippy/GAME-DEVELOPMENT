<!DOCTYPE html>
<html lang="en" translate="no">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>身体部位 – 选择单词</title>
<style>
html, body {
  height: 90vh;
  overflow: hidden;
}
body {
  font-family: Arial, sans-serif;
  background: #f7f7fa;
  display: flex;
  justify-content: center;
  padding: 20px;
  margin: 0;
  flex-direction: column;
  align-items: center;
}
h1 {
    color: #333;
}
.container {
  display: flex;
  gap: 30px;
  align-items: flex-start;
  max-width: 90vw;
}
.questions {
  display: flex;
  flex-direction: column;
  gap: 6px;
  width: 200px;
}
.question-box {
  border-radius: 8px;
  padding: 8px;
  transition: box-shadow 0.3s ease, border 0.3s ease;
  display: flex;
  flex-direction: column;
  position: relative;
}
.question-box.highlight {
  box-shadow: 0 0 8px 4px #ffe16a;
  border: 2px solid #ffe16a;
}
select {
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #aaa;
  width: 100%;
  font-size: 16px;
}
svg {
  width: 300px;
  max-width: 40vw;
  height: auto;
}
.part-fill {
  fill-opacity: .55;
  stroke: #333;
  stroke-width: 1;
  transition: stroke 0.2s, stroke-width 0.2s;
}
.part-fill.highlight-part {
  stroke: gold !important;
  stroke-width: 4 !important;
}
.status {
  position: absolute;
  left: -20px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 20px;
}
#completion-message {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #4CAF50;
  color: white;
  padding: 20px;
  border-radius: 8px;
  font-size: 24px
}
</style>
</head>
<body class="notranslate">
<h1>身体部位 (Shēntǐ bùwèi) - Body Parts</h1>
<div id="score">Score: 0/20</div>
<div class="container">
  <!-- Left column -->
  <div class="questions" id="left-questions"></div>

  <!-- Body diagram -->
  <svg viewBox="0 0 260 520" aria-label="Body diagram">
    <!-- Head & neck -->
    <circle id="tou-part" class="part-fill" cx="130" cy="70" r="48"/>
    <rect id="bozi-part" class="part-fill" x="115" y="110" width="30" height="26" rx="6"/>
    <!-- Ears -->
    <ellipse id="erduoL-part" class="part-fill" cx="78" cy="75" rx="10" ry="18"/>
    <ellipse id="erduoR-part" class="part-fill" cx="182" cy="75" rx="10" ry="18"/>
    <!-- Eyebrows -->
    <path id="meimaoL-part" class="part-fill" d="M105 57 Q115 50 125 55" />
    <path id="meimaoR-part" class="part-fill" d="M135 55 Q145 50 155 57" />
    <!-- Eyes -->
    <circle id="yanjingL-part" class="part-fill" cx="118" cy="66" r="6"/>
    <circle id="yanjingR-part" class="part-fill" cx="142" cy="66" r="6"/>
    <!-- Nose -->
    <path id="bizi-part" class="part-fill" d="M130 68 L135 82 L125 82 Z"/>
    <!-- Mouth, lips, teeth, chin -->
    <rect id="zuiba-part" class="part-fill" x="113" y="90" width="34" height="12" rx="3"/>
    <path id="zuichun-part" class="part-fill" d="M115 96 Q130 104 147 96" fill="none"/>
    <rect id="yachi-part" class="part-fill" x="118" y="92" width="24" height="7" rx="1"/>
    <rect id="xiahe-part" class="part-fill" x="118" y="102" width="24" height="8" rx="4"/>
    <!-- Torso & limbs -->
    <rect id="jianbang-part" class="part-fill" x="80" y="135" width="100" height="18" rx="8"/>
    <rect id="xiongbu-part" class="part-fill" x="85" y="155" width="90" height="42" rx="10"/>
    <rect id="duzi-part" class="part-fill" x="85" y="199" width="90" height="50" rx="10"/>
    <rect id="tunbu-part" class="part-fill" x="88" y="251" width="84" height="16" rx="6"/>
    <rect id="shoubiL-part" class="part-fill" x="65" y="150" width="20" height="80" rx="8"/>
    <rect id="shoubiR-part" class="part-fill" x="175" y="150" width="20" height="80" rx="8"/>
    <circle id="shouL-part" class="part-fill" cx="75" cy="240" r="12"/>
    <circle id="shouR-part" class="part-fill" cx="185" cy="240" r="12"/>
    <rect id="shouzhiL-part" class="part-fill" x="62" y="252" width="26" height="10" rx="3"/>
    <rect id="shouzhiR-part" class="part-fill" x="172" y="252" width="26" height="10" rx="3"/>
    <rect id="tuiL-part" class="part-fill" x="98" y="268" width="20" height="120" rx="8"/>
    <rect id="tuiR-part" class="part-fill" x="142" y="268" width="20" height="120" rx="8"/>
    <circle id="xigaiL-part" class="part-fill" cx="108" cy="338" r="8"/>
    <circle id="xigaiR-part" class="part-fill" cx="152" cy="338" r="8"/>
    <rect id="jiaoL-part" class="part-fill" x="90" y="388" width="36" height="16" rx="4"/>
    <rect id="jiaoR-part" class="part-fill" x="134" y="388" width="36" height="16" rx="4"/>
  </svg>

  <!-- Right column -->
  <div class="questions" id="right-questions"></div>
</div>

<div id="completion-message">很好！</div>
<button id="next-question">下一题</button>

<script>
// Debug log to confirm script execution
console.log("JavaScript is running! Generating dropdowns...");

const items = [
  {key:"tou", zh:"头", en:"Head", parts:["tou-part"]},
  {key:"bozi", zh:"脖子", en:"Neck", parts:["bozi-part"]},
  {key:"erduo", zh:"耳朵", en:"Ears", parts:["erduoL-part","erduoR-part"]},
  {key:"meimao", zh:"眉毛", en:"Eyebrows", parts:["meimaoL-part","meimaoR-part"]},
  {key:"yanjing", zh:"眼睛", en:"Eyes", parts:["yanjingL-part","yanjingR-part"]},
  {key:"bizi", zh:"鼻子", en:"Nose", parts:["bizi-part"]},
  {key:"zuiba", zh:"嘴巴", en:"Mouth", parts:["zuiba-part"]},
  {key:"zuichun", zh:"嘴唇", en:"Lips", parts:["zuichun-part"]},
  {key:"yachi", zh:"牙齿", en:"Teeth", parts:["yachi-part"]},
  {key:"xiahe", zh:"下颌", en:"Chin", parts:["xiahe-part"]},
  {key:"jianbang", zh:"肩膀", en:"Shoulders", parts:["jianbang-part"]},
  {key:"xiongbu", zh:"胸部", en:"Chest", parts:["xiongbu-part"]},
  {key:"duzi", zh:"肚子", en:"Stomach", parts:["duzi-part"]},
  {key:"tunbu", zh:"臀部", en:"Hips", parts:["tunbu-part"]},
  {key:"shoubi", zh:"手臂", en:"Arms", parts:["shoubiL-part","shoubiR-part"]},
  {key:"shou", zh:"手", en:"Hands", parts:["shouL-part","shouR-part"]},
  {key:"shouzhi", zh:"手指", en:"Fingers", parts:["shouzhiL-part","shouzhiR-part"]},
  {key:"xigai", zh:"膝盖", en:"Knees", parts:["xigaiL-part","xigaiR-part"]},
  {key:"tui", zh:"腿", en:"Legs", parts:["tuiL-part","tuiR-part"]},
  {key:"jiao", zh:"脚", en:"By foot", parts:["jiaoL-part","jiaoR-part"]}
];

const palette = [
  "#a3d8ff","#fdd28a","#ffc0cb","#b19cd9","#90ee90",
  "#ffe066","#ff9999","#99e6ff","#c2f0c2","#ffccf2",
  "#ffd1a9","#bfe6ff","#ffd6e7","#c6ffd1","#d1c6ff",
  "#f6ffa6","#ffb3b3","#b3ffd9","#d9b3ff","#ffdcb3"
];

const allChinese = items.map(x => x.zh);
let currentQuestionIndex = 0;
let score = 0;
const totalQuestions = items.length;

function shuffle(a) { return a.sort(() => Math.random() - 0.5); }
function shade(hex, p) {
  const f = parseInt(hex.slice(1), 16), t = p < 0 ? 0 : 255, pct = Math.abs(p) / 100;
  const n = x => Math.round((t - x) * pct + x);
  return "#" + (0x1000000 + (n(f >> 16) << 16) + (n(f >> 8 & 0x00FF) << 8) + n(f & 0x0000FF)).toString(16).slice(1);
}

function updateScore() {
  document.getElementById('score').textContent = `Score: ${score}/${totalQuestions}`;
}

function checkCompletion() {
  const allSelects = document.querySelectorAll('select');
  const allCorrect = Array.from(allSelects).every(sel => sel.dataset.correct === 'true');
  if (allCorrect) {
    document.getElementById('completion-message').style.display = 'block';
  }
}

function showNextQuestion() {
  const questionBoxes = document.querySelectorAll('#left-questions .question-box');
  questionBoxes.forEach((box, index) => {
    box.classList.toggle('active', index === currentQuestionIndex);
  });
  if (currentQuestionIndex >= totalQuestions - 1) {
    document.getElementById('next-question').style.display = 'none';
  }
}

// Explicitly split items: first 10 to left, last 10 to right (on desktop)
const leftItems = items.slice(0, 10);
const rightItems = items.slice(10, 20);

[leftItems, rightItems].forEach((itemGroup, groupIndex) => {
  const side = window.innerWidth > 768 ? (groupIndex === 0 ? "left" : "right") : "left";
  const panel = document.getElementById(side + "-questions");

  itemGroup.forEach((it, i) => {
    console.log(`Creating dropdown for ${it.zh} on ${side} side, index ${i}`);
    const wrap = document.createElement("div");
    wrap.className = "question-box";
    wrap.style.backgroundColor = palette[(groupIndex * 10 + i) % palette.length];
    if (side === "left" && i === 0) wrap.classList.add('active');

    const sel = document.createElement("select");
    const placeholder = document.createElement("option");
    placeholder.value = ""; placeholder.text = "--选择--";
    sel.appendChild(placeholder);

    const opts = shuffle([it.zh, ...shuffle(allChinese.filter(w => w !== it.zh)).slice(0, 3)]);
    opts.forEach(o => {
      const op = document.createElement("option");
      op.value = o;
      op.textContent = o;
      sel.appendChild(op);
    });

    const status = document.createElement("span");
    status.className = "status";
    wrap.appendChild(status);
    wrap.appendChild(sel);
    panel.appendChild(wrap);

    const parts = it.parts;
    const addGlow = () => parts.forEach(pid => document.getElementById(pid)?.classList.add("highlight-part"));
    const removeGlow = () => parts.forEach(pid => document.getElementById(pid)?.classList.remove("highlight-part"));
    wrap.addEventListener("mouseenter", () => { wrap.classList.add("highlight"); addGlow(); });
    wrap.addEventListener("mouseleave", () => { wrap.classList.remove("highlight"); removeGlow(); });
    sel.addEventListener("focusin", () => { wrap.classList.add("highlight"); addGlow(); });
    sel.addEventListener("blur", () => { wrap.classList.remove("highlight"); removeGlow(); });

    sel.addEventListener("change", () => {
      if (sel.value === it.zh) {
        sel.value = it.zh;
        sel.innerHTML = `<option value="${it.zh}" selected>${it.zh} (${it.en})</option>`;
        status.textContent = "✓";
        status.style.color = "green";
        sel.dataset.correct = "true";
        if (!sel.dataset.scored) {
          score++;
          sel.dataset.scored = "true";
          updateScore();
        }
      } else if (sel.value) {
        status.textContent = "✗";
        status.style.color = "red";
        sel.dataset.correct = "false";
      } else {
        status.textContent = "";
        sel.dataset.correct = "false";
      }
      checkCompletion();
      if (window.innerWidth <= 768) {
        document.getElementById('next-question').style.display = 'block';
      }
    });

    parts.forEach(pid => {
      const el = document.getElementById(pid);
      if (!el) return;
      if (el.tagName !== "line") el.setAttribute("fill", palette[(groupIndex * 10 + i) % palette.length]);
      el.setAttribute("stroke", shade(palette[(groupIndex * 10 + i) % palette.length], -25));
    });
  });
});

document.getElementById('next-question').addEventListener('click', () => {
  currentQuestionIndex++;
  showNextQuestion();
});

if (window.innerWidth <= 768) {
  showNextQuestion();
}

updateScore();
</script>
</body>
</html>